extends layout

block content
  .timeline
    .homemenu
      img.guideimg(src='/images/guide.png' alt='chat guide')
  p
  #slider
    .item(onclick="window.open(`http://www.cku.ac.kr`)" style='cursor:pointer;')
    .item(onclick="window.open(`http://www.cku.ac.kr`)" style='cursor:pointer;')
    .item(onclick="window.open(`http://www.cku.ac.kr`)" style='cursor:pointer;')
  .button-box
    a(href='#' onclick='slider.prev()')
      i.fa.fa-chevron-left
    a(href='#' onclick='slider.next()')
      i.fa.fa-chevron-right
    a(href='#' onclick='slider.auto()')
      i.fa.fa-play
    a(href='#' onclick='slider.stop()')
      i.fa.fa-stop
  script(src='js/roll.js')
  if user
    .chat-bar
      button#chat-button.collapsible(type='button') ê°€í†¨ë¦­ê´€ë™ëŒ€í•™êµ
        i#chat-icon.fa.fa-fw.fa-comments-o(style='color: #fff;')
      .content
        .full-chat-block
          .outer-container
            .chat-container
              #chatbox
                h5#chat-timestamp
                p#botStarterMessage.botText
                  span Loading...
              .chat-bar-input-block
                #userInput
                  input#textInput.input-box(type='text' name='msg' placeholder='ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”')
                  p
                script.
                  $(function () {
                    $("#textInput").autocomplete({
                      source: List,
                      focus : function(event, ui) {
                        return false;
                      },
                      minLength: 1,
                      delay: 100,
                      position: { collision: 'flip' } //ìë™ì™„ì„± ìœ„ì¹˜ ë°˜ì‘í˜•
                    });
                  });
                .chat-bar-icons
                  i#chat-icon.fa.fa-bars(style='color: #333;' onclick='menuButton()')
                  i#chat-icon.fa.fa-fw.fa-send(style='color: #333;' onclick='sendButton()')
              #chat-bar-bottom
                p
    script(src='js/Chat.js')
    script.
      var name = `#{user.nick}`;
      kk = newKk();
      sw = kk[0];
      arch = kk[1];
      arche = kk[2];
      civil = kk[3];
      elec = kk[4];
      mp = newMp();
      ttyear = mp[0];
      toyear = mp[1];
      all = newAll();
      calsel = all[0];
      kkinfomenu = all[1];
      phone = all[2];
      menu = all[3];
      facil = all[4];
      depphone = newDepphone();
      archep = depphone[0];
      archp = depphone[1];
      swp = depphone[2];
      elecp = depphone[3];
      civilp = depphone[4];
      mainp = newMainphone();


      function firstBotMessage() {
        let firstMessage = `<p class="botText">
                              <div  style="word-break: break-word;">
                                ${name}ë‹˜ ì•ˆë…•í•˜ì„¸ìš”!ğŸ˜Š<br>ì´ë²ˆ ë‹¬ì˜ ì£¼ìš” í•™ì‚¬ì¼ì •ì´ì—ìš”!ğŸ“†
                              </div>
                              <p></p>
                              <div id='calendar'></div>
                              <p></p>
                              <div class="btn_group">
                                <a class="btn_link" onclick='menuButton()'>ì±—ë´‡ ì‹œì‘í•˜ê¸° ğŸ’¬</a>
                              </div>
                            </p>`
        document.getElementById("botStarterMessage").innerHTML = `<span>${firstMessage}</span>`;
        document.getElementById("userInput").scrollIntoView(false);
      }
      firstBotMessage();

      function selectMonth(imsimonth) {
        imsi = imsimonth;
      }
      function getBotResponse(input) {
        //ì‚¬ìš©ìì •ë³´
        var dname = `#{user.dnick}`;
        var depa = #{user.dcategory};
        var year = #{user.uyear};
        var grade = #{user.grade};
        var kp = #{user.ascore};
        var ks = #{user.bscore};
        var jg = #{user.cscore};
        var ib = #{user.dscore};
        var tt = #{user.escore};
        

        if  (input == "menu") {
          return `${menu}`;
        }	
        else if (input == "kkinfo") {
          return `${kkinfomenu}`;
        }
        else if (input == "phoneinfo") {
          return `${phone}`;
        }
        else if (input == "facilinfo") {
          return `${facil}`;
        }
        else if (input == "ë‹¬ë ¥ì„ íƒ") {
          return `${calsel}`;
        }
        else if (input == "í•™ì‚¬ì¼ì •") {
          switch(imsi) {
            case 1 : return `${imsi}ì›” í•™ì‚¬ì¼ì •ì…ë‹ˆë‹¤.<br>`;
              break;
            case 2 : return `${imsi}ì›” í•™ì‚¬ì¼ì •ì…ë‹ˆë‹¤.<br>`;
              break;
            case 3 : return `${imsi}ì›” í•™ì‚¬ì¼ì •ì…ë‹ˆë‹¤.<br>`;
              break;
            case 4 : return `${imsi}ì›” í•™ì‚¬ì¼ì •ì…ë‹ˆë‹¤.<br>`;
              break;
            case 5 : return `${imsi}ì›” í•™ì‚¬ì¼ì •ì…ë‹ˆë‹¤.<br>05ì¼ : ì–´ë¦°ì´ë‚  [ê³µíœ´ì¼]<br>09ì¼-13ì¼ : ì¤‘ê°„ ì„±ì  ì—´ëŒ<br>30ì¼-6ì›” 3ì¼ : ë³µìˆ˜,ë¶€ì „ê³µ ì‹ ì²­`;
              break;
            case 6 : return `${imsi}ì›” í•™ì‚¬ì¼ì •ì…ë‹ˆë‹¤.<br>01ì¼ : ì§€ë°©ì„ ê±° [ê³µíœ´ì¼]<br>06ì¼ : í˜„ì¶©ì¼ [ê³µíœ´ì¼]<br>08ì¼-20ì¼ : ë³´ê°• ë° ê¸°ë§ ê³ ì‚¬<br>08ì¼-24ì¼ : ê¸°ë§ ì„±ì  ì…ë ¥<br>20ì¼ : 1í•™ê¸° ì¢…ê°•<br>27ì¼-29ì¼ : í•˜ê³„ ê³„ì ˆí•™ê¸° ì„±ì  í¬ê¸°<br>27ì¼ : í•˜ê³„ ê³„ì ˆí•™ê¸° ê°œê°•<br>27ì¼-7ì›” 1ì¼ : ì„±ì ì—´ëŒ ë° ì´ì˜ì‹ ì²­`;
              break;
            case 7 : return `${imsi}ì›” í•™ì‚¬ì¼ì •ì…ë‹ˆë‹¤.<br>`;
              break;
            case 8 : return `${imsi}ì›” í•™ì‚¬ì¼ì •ì…ë‹ˆë‹¤.<br>`;
              break;
            case 9 : return `${imsi}ì›” í•™ì‚¬ì¼ì •ì…ë‹ˆë‹¤.<br>`;
              break;
            case 10 : return `${imsi}ì›” í•™ì‚¬ì¼ì •ì…ë‹ˆë‹¤.<br>`;
              break;
            case 11 : return `${imsi}ì›” í•™ì‚¬ì¼ì •ì…ë‹ˆë‹¤.<br>`;
              break;
            case 12 : return `${imsi}ì›” í•™ì‚¬ì¼ì •ì…ë‹ˆë‹¤.<br>`;
              break;
            default: window.open("https://www.cku.ac.kr/cku/428/subview.do","í•™ì‚¬ì¼ì •"); return ``;
          }
        }
        //êµìœ¡ê³¼ì •
        else if (input == "êµìœ¡ê³¼ì •") {
          switch(dname)  {
            case `ì†Œí”„íŠ¸ì›¨ì–´` : return `${sw}`;
              break;
            case `ê±´ì¶•` : return `${arch}`;
              break;
            case `ì „ìê³µ` : return `${elec}`;
              break;
            case `í† ëª©` : return `${civil}`;
              break;
            case `ê±´ì¶•ê³µ` : return `${arche}`;
              break;
            default: return `ì¤€ë¹„ ì¤‘ì¸ í•™ê³¼ êµìœ¡ê³¼ì •ì…ë‹ˆë‹¤.`;
          }
        }
        else if (input == "ì†Œí”„íŠ¸ì›¨ì–´í•™ê³¼ êµìœ¡ê³¼ì •") {return `${sw}`;}
        else if (input == "ê±´ì¶•í•™ë¶€ êµìœ¡ê³¼ì •") {return `${arch}`;}
        else if (input == "ì „ìê³µí•™ê³¼ êµìœ¡ê³¼ì •") {return `${elec}`;}
        else if (input == "í† ëª©ê³µí•™ê³¼ êµìœ¡ê³¼ì •") {return `${civil}`;}
        else if (input == "ê±´ì¶•ê³µí•™ê³¼ êµìœ¡ê³¼ì •") {return `${arche}`;}
        //ë‚´ ë‚¨ì€í•™ì 
        else if (input == "ë‚¨ì€í•™ì ") {
          if (year == 2017) {
            switch(depa)  {
              case 0 : return `ì¡¸ì—…ê¹Œì§€ ë‚¨ì€ í•™ì ì€ êµí•„ ${28-kp}ì , êµì„  ${8-ks}ì , ì „ê³µ ${69-jg}ì , ì¼ì„  ${25-ib}ì , ì´ ${130-tt}ì  ì…ë‹ˆë‹¤.`;
                break;
              case 1 : return `ì¡¸ì—…ê¹Œì§€ ë‚¨ì€ í•™ì ì€ êµí•„ ${28-kp}ì , êµì„  ${8-ks}ì , ì „ê³µ ${106-jg}ì , ì¼ì„  ${18-ib}ì , ì´ ${160-tt}ì  ì…ë‹ˆë‹¤.`;
                break;
              default: return `ì˜ëª»ëœ ì •ë³´ì…ë‹ˆë‹¤.`;
            }
          } else if (year == 2018)  {
              switch(depa)  {
                case 0 : return `ì¡¸ì—…ê¹Œì§€ ë‚¨ì€ í•™ì ì€ êµí•„ ${16-kp}ì , êµì„  ${20-ks}ì , ì „ê³µ ${69-jg}ì , ì¼ì„  ${25-ib}ì , ì´ ${130-tt}ì  ì…ë‹ˆë‹¤.`;
                  break;
                case 1 : return `ì¡¸ì—…ê¹Œì§€ ë‚¨ì€ í•™ì ì€ êµí•„ ${16-kp}ì , êµì„  ${20-ks}ì , ì „ê³µ ${106-jg}ì , ì¼ì„  ${18-ib}ì , ì´ ${160-tt}ì  ì…ë‹ˆë‹¤.`;
                  break;
                default: return `ì˜ëª»ëœ ì •ë³´ì…ë‹ˆë‹¤.`;
              }
          } else {
            return `${year}ë…„ë„ ${dname}í•™ê³¼ ì¡¸ì—… ì •ë³´ê°€ ì•„ì§ ë“±ë¡ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.`;
          }
        }
        //ì´ìˆ˜í•™ì 
        else if (input == "ìµœì†Œì´ìˆ˜í•™ì ") {
          switch(year)  {
            case 2022 : return `${ttyear}`;
              break;
            case 2021 : return `${toyear}`;
              break;
            case 2020 : return `${tzyear}`;
              break;
            case 2019 : return `${onyear}`;
              break;
            case 2018 : return `${oeyear}`;
              break;
            case 2017 : return `${osyear}`;
              break;
            case 2016 : return `${osixyear}`;
              break;
            case 2015 : return `${ofyear}`;
              break;
            case 2014 : return `${ofouryear}`;
              break;
            case 2013 : return `${othreeyear}`;
              break;
            case 2012 : return `${otyear}`;
              break;
            case 2011 : return `${ooyear}`;
              break;
            case 2010 : return `${ozyear}`;
              break;
            case 2009 : return `${nyear}`;
              break;
            case 2008 : return `${eyear}`;
              break;
            default: return `í•´ë‹¹ í•™ë²ˆì— ëŒ€í•œ ì •ë³´ëŠ” êµí•™ì²˜ë¡œ ë¬¸ì˜í•´ì£¼ì„¸ìš”!`;
          }
        }
        else if (input == "2022í•™ë²ˆ ì´ìˆ˜í•™ì ") {return `${ttyear}`;}
        else if (input == "2021í•™ë²ˆ ì´ìˆ˜í•™ì ") {return `${toyear}`;}
        else if (input == "2020í•™ë²ˆ ì´ìˆ˜í•™ì ") {return `${tzyear}`;}
        else if (input == "2019í•™ë²ˆ ì´ìˆ˜í•™ì ") {return `${onyear}`;}
        else if (input == "2018í•™ë²ˆ ì´ìˆ˜í•™ì ") {return `${oeyear}`;}
        else if (input == "2017í•™ë²ˆ ì´ìˆ˜í•™ì ") {return `${osyear}`;}
        else if (input == "2016í•™ë²ˆ ì´ìˆ˜í•™ì ") {return `${osixyear}`;}
        else if (input == "2015í•™ë²ˆ ì´ìˆ˜í•™ì ") {return `${ofyear}`;}
        else if (input == "2014í•™ë²ˆ ì´ìˆ˜í•™ì ") {return `${ofouryear}`;}
        else if (input == "2013í•™ë²ˆ ì´ìˆ˜í•™ì ") {return `${othreeyear}`;}
        else if (input == "2012í•™ë²ˆ ì´ìˆ˜í•™ì ") {return `${otyear}`;}
        else if (input == "2011í•™ë²ˆ ì´ìˆ˜í•™ì ") {return `${ooyear}`;}
        else if (input == "2010í•™ë²ˆ ì´ìˆ˜í•™ì ") {return `${ozyear}`;}
        else if (input == "2009í•™ë²ˆ ì´ìˆ˜í•™ì ") {return `${nyear}`;}
        else if (input == "2008í•™ë²ˆ ì´ìˆ˜í•™ì ") {return `${eyear}`;}
        //ìº í¼ìŠ¤ë§µ
        else if (input == "ìº í¼ìŠ¤ë§µ") {
          return `<div style="word-break: break-word;">
                    ìº í¼ìŠ¤ë§µì´ì—ìš”! ì›í•˜ëŠ” ì¥ì†Œë¥¼ ì°¾ì•„ë³´ì„¸ìš”!
                  </div>
                  <p></p>
                  <div class="btn_group">
                    <img src="images/campusmap.jpg" width="400px" height="150px" image-rendering= "-webkit-optimize-contrast">
                  </div>`;
        }
        //í•™ê³¼ì—°ë½ì²˜
        else if (input == "í•™ê³¼ì—°ë½ì²˜") {
          switch(dname)  {
            case `ì†Œí”„íŠ¸ì›¨ì–´` : return `${swp}`;
              break;
            case `ê±´ì¶•` : return `${archp}`;
              break;
            case `ì „ìê³µ` : return `${elecp}`;
              break;
            case `í† ëª©` : return `${civilp}`;
              break;
            case `ê±´ì¶•ê³µ` : return `${archep}`;
              break;
            default: return `ì¤€ë¹„ ì¤‘ì¸ í•™ê³¼ êµìœ¡ê³¼ì •ì…ë‹ˆë‹¤.`;
          }
        }
        else if (input == "ì†Œí”„íŠ¸ì›¨ì–´í•™ê³¼ ì—°ë½ì²˜") {return `${swp}`;}
        else if (input == "ê±´ì¶•í•™ë¶€ ì—°ë½ì²˜") {return `${archep}`;}
        else if (input == "ì „ìê³µí•™ê³¼ ì—°ë½ì²˜") {return `${elecp}`;}
        else if (input == "í† ëª©ê³µí•™ê³¼ ì—°ë½ì²˜") {return `${civilp}`;}
        else if (input == "ê±´ì¶•ê³µí•™ê³¼ ì—°ë½ì²˜") {return `${archep}`;}
        //ì£¼ìš” ì—°ë½ì²˜
        else if (input == "ì£¼ìš” ì—°ë½ì²˜") {return `${mainp}`;}
        //
        else {return "ì˜ ì´í•´í•˜ì§€ ëª»í–ˆì–´ìš”. ì§ˆë¬¸ì„ í™•ì¸í•´ì£¼ì„¸ìš”";} 
      }